"use strict";(self["webpackChunkdobby_web"]=self["webpackChunkdobby_web"]||[]).push([[371],{3371:function(e,t,o){o.r(t),o.d(t,{default:function(){return ye}});var r=o(3396);const i=(0,r._)("div",{class:"content-header"},[(0,r._)("h1",null," 휴일 출근 관리 ")],-1);function n(e,t,o,n,a,s){const l=(0,r.up)("HolidayWorkTableContainer");return(0,r.wg)(),(0,r.iD)(r.HY,null,[i,(0,r.Wm)(l)],64)}var a=o(7139),s=o(9242);const l={class:"content-container"},d={class:"search-input-container"},m={class:"input-group"},y=["value"],p=(0,r._)("option",{value:null},"월",-1),u=["value"],c={class:"input-group-append"};function h(e,t,o,i,n,h){const I=(0,r.up)("EditableTable");return(0,r.wg)(),(0,r.iD)("div",l,[(0,r._)("div",d,[(0,r._)("div",m,[(0,r.wy)((0,r._)("select",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.year=t),class:"year-input"},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(h.years,(e=>((0,r.wg)(),(0,r.iD)("option",{value:e},(0,a.zw)(e),9,y)))),256))],512),[[s.bM,e.year]]),(0,r.wy)((0,r._)("select",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.month=t),class:"month-input"},[p,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(h.months,(e=>((0,r.wg)(),(0,r.iD)("option",{value:e},(0,a.zw)(e),9,u)))),256))],512),[[s.bM,e.month]]),(0,r.wy)((0,r._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=t=>e.query=t)},null,512),[[s.nr,e.query]]),(0,r._)("div",c,[(0,r._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[3]||(t[3]=(...e)=>h.searchQuery&&h.searchQuery(...e))},"검색")])])]),(0,r.Wm)(I,{"use-index":!1,"header-infos":e.headerInfos,"table-data":e.holidayWorkList,"empty-item":h.getEmptyItem(),onInsertItem:h.insertItem,onUpdateItem:h.updateItem,onDeleteItem:h.deleteItem},null,8,["header-infos","table-data","empty-item","onInsertItem","onUpdateItem","onDeleteItem"])])}o(560);var I=o(6680),k={HolidayWork:class{constructor({holidayWorkId:e,employeeNo:t,name:o,workDate:r,memo:i,rankName:n}){this.holidayWorkId=e||99999999999,this.employeeNo=t||"",this.name=o||"",this.workDate=r||"",this.memo=i||"",this.rankName=n||""}},async getHolidayWorkList({query:e="",pageNum:t=0,pageSize:o=10,year:r,month:i}){try{let n=`http://localhost:8080/holiday/work/list?pageNum=${t}&pageSize=${o}`;e&&(n+=`&query=${e}`),r&&(n+=`&year=${r}`),i&&(n+=`&month=${i}`);const a=await I.Z.GET(n);return a.result?a.result.map((e=>new this.HolidayWork(e))):[]}catch(n){return[]}},async insertHolidayWork(e){if(!e instanceof this.HolidayWork&&console.log("저장 할 데이터가 HolidayWork 형식이 아닙니다."),!e.employeeNo)return alert("사번이 선택되지 않았습니다."),!1;if(!e.workDate)return alert("날짜가 선택되지 않았습니다."),!1;const t={employeeNo:e.employeeNo,workDate:e.workDate,memo:e.memo};return await I.Z.POST("http://localhost:8080/holiday/work/save",t),!0},async updateHolidayWork(e,t){return"number"!==typeof e?(console.log("holidayWorkId가 number형식이 아닙니다."),!1):!t instanceof this.HolidayWork?(console.log("수정 할 데이터가 HolidayWork 형식이 아닙니다."),!1):t.employeeNo?t.workDate?(await I.Z.PUT(`http://localhost:8080/holiday/work/modify/${e}`,t),!0):(alert("날짜가 선택되지 않았습니다."),!1):(alert("사번이 선택되지 않았습니다."),!1)},async deleteHolidayWork(e){return"number"!==typeof e?(console.log("holidayWorkId가 number형식이 아닙니다."),!1):(await I.Z.DELETE(`http://localhost:8080/holiday/work/delete/${e}`),!0)},async getSimpleEmployeeList(){try{const e=await I.Z.GET("http://localhost:8080/employee/simple-info");return e.result}catch(e){return[]}}};const w={class:"table-container bd-solid mg-t-3 pd-lr-1r"},f={class:"table",id:"holiday-work-table"},g={key:1},b=["colspan"];function N(e,t,o,i,n,a){const s=(0,r.up)("EditableTableHeader"),l=(0,r.up)("EditableTableRow");return(0,r.wg)(),(0,r.iD)("div",w,[(0,r._)("table",f,[(0,r.Wm)(s,{"header-infos":o.headerInfos,"use-index":o.useIndex},null,8,["header-infos","use-index"]),(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.tableData,((e,t)=>((0,r.wg)(),(0,r.j4)(l,{"use-index":o.useIndex,item:e,"init-is-update":!1,"is-insert":!1,"header-infos":o.headerInfos,index:t+1,onUpdateItem:a.updateItem,onDeleteItem:a.deleteItem},null,8,["use-index","item","header-infos","index","onUpdateItem","onDeleteItem"])))),256)),e.isInsert?((0,r.wg)(),(0,r.j4)(l,{key:0,"use-index":o.useIndex,"init-is-update":!0,"init-is-insert":!0,item:o.emptyItem,"header-infos":o.headerInfos,index:0,onInsertItem:a.insertItem,onUpdateItem:a.updateItem,onDeleteItem:a.deleteItem},null,8,["use-index","item","header-infos","onInsertItem","onUpdateItem","onDeleteItem"])):((0,r.wg)(),(0,r.iD)("tr",g,[(0,r._)("td",{colspan:a.columnLength,class:"ta-c clickable",onClick:t[0]||(t[0]=(...e)=>a.useInsert&&a.useInsert(...e))},"+",8,b)]))])])])}class v{constructor({itemPropertyName:e,selectBoxItemPropertyName:t}){this._itemPropertyName=e,this._selectBoxItemPropertyName=t}get itemPropertyName(){return this._itemPropertyName}get selectBoxItemPropertyName(){return this._selectBoxItemPropertyName}}class D{constructor({key:e,value:t,view:o}){this._key=e,this._value=t,this._view=o}get key(){return this._key}get view(){return this._view}get value(){return this._value}change(e,t){if(e&&t)for(const o of t)e[o.itemPropertyName]=this._value[o.selectBoxItemPropertyName]}}class x{constructor({selectBoxListItems:e,changeInfos:t}){this._selectBoxListItems=e,this._changeInfos=t}get selectBoxListItems(){return this._selectBoxListItems}get changeInfos(){return this._changeInfos}}class _{constructor({isId:e,propertyOrder:t,propertyName:o,columnName:r,isVisible:i,isModify:n,modifyType:a,selectBoxInfo:s}){this._propertyOrder=t||999,this._isId=e,this._propertyName=o||"",this._columnName=r||"",this._isVisible=i||"undefined"===typeof i,this._isModify=n||"undefined"!==typeof a,this._modifyType="string"===typeof a?a:"text",this._selectBoxInfo=s||{}}get isId(){return this._isId}get propertyName(){return this._propertyName}get propertyOrder(){return this._propertyOrder}get columnName(){return this._columnName}get isVisible(){return this._isVisible}get isModify(){return this._isModify}get modifyType(){return this._modifyType}get selectBoxInfo(){return this._selectBoxInfo}}const B={key:0,scope:"col"},H={scope:"col"},W=(0,r._)("th",{scope:"col"},"수정",-1),E=(0,r._)("th",{scope:"col"},"삭제",-1);function C(e,t,o,i,n,s){return(0,r.wg)(),(0,r.iD)("thead",null,[(0,r._)("tr",null,[o.useIndex?((0,r.wg)(),(0,r.iD)("th",B,"순번")):(0,r.kq)("",!0),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.orderedHeaders,(e=>((0,r.wg)(),(0,r.iD)("th",H,(0,a.zw)(e),1)))),256)),W,E])])}var T={name:"EditableTableHeader",props:{useIndex:Boolean,headerInfos:Array},computed:{orderedHeaders(){return this.headerInfos.sort(((e,t)=>e.propertyOrder-t.propertyOrder)).filter((e=>e.isVisible)).map((e=>e.columnName))}}},U=o(89);const L=(0,U.Z)(T,[["render",C]]);var P=L;const O={key:0},V={key:0,class:"editable-td"},$=["onUpdate:modelValue"],Y={key:1,class:"editable-td"},z=["onChange"],q=(0,r._)("option",{disabled:""},"사번/이름",-1),M=["value"],Z={key:2,class:"editable-td"},A=["onUpdate:modelValue"],K={key:3,class:"editable-td"},S={key:0,class:"editable-td"},j={key:1,class:"editable-td"},Q={key:2,class:"editable-td"},R={key:3,class:"editable-td"},F={class:"editable-button"},G={class:"editable-button"};function J(e,t,o,i,n,l){return(0,r.wg)(),(0,r.iD)("tr",null,[o.useIndex?((0,r.wg)(),(0,r.iD)("td",O,(0,a.zw)(o.index),1)):(0,r.kq)("",!0),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.headerInfos,(t=>((0,r.wg)(),(0,r.iD)(r.HY,null,[t.isVisible?((0,r.wg)(),(0,r.iD)(r.HY,{key:0},[t.isModify&&e.isUpdate?((0,r.wg)(),(0,r.iD)(r.HY,{key:0},["text"===t.modifyType?((0,r.wg)(),(0,r.iD)("td",V,[(0,r.wy)((0,r._)("input",{class:"text-input",type:"text","onUpdate:modelValue":e=>o.item[t.propertyName]=e},null,8,$),[[s.nr,o.item[t.propertyName]]])])):"selectBox"===t.modifyType?((0,r.wg)(),(0,r.iD)("td",Y,[(0,r._)("select",{onChange:e=>l.selectBoxChangeEvent(e,t)},[q,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.selectBoxInfo.selectBoxListItems,(e=>((0,r.wg)(),(0,r.iD)("option",{key:e.key,value:e.key},(0,a.zw)(e.view),9,M)))),128))],40,z)])):"date"===t.modifyType?((0,r.wg)(),(0,r.iD)("td",Z,[(0,r.wy)((0,r._)("input",{class:"date-input",type:"date","onUpdate:modelValue":e=>o.item[t.propertyName]=e},null,8,A),[[s.nr,o.item[t.propertyName]]])])):((0,r.wg)(),(0,r.iD)("td",K,(0,a.zw)(o.item[t.propertyName]),1))],64)):((0,r.wg)(),(0,r.iD)(r.HY,{key:1},["text"===t.modifyType?((0,r.wg)(),(0,r.iD)("td",S,(0,a.zw)(o.item[t.propertyName]),1)):"selectBox"===t.modifyType?((0,r.wg)(),(0,r.iD)("td",j,(0,a.zw)(o.item[t.propertyName]),1)):"date"===t.modifyType?((0,r.wg)(),(0,r.iD)("td",Q,(0,a.zw)(o.item[t.propertyName]),1)):((0,r.wg)(),(0,r.iD)("td",R,(0,a.zw)(o.item[t.propertyName]),1))],64))],64)):(0,r.kq)("",!0)],64)))),256)),(0,r._)("td",F,[e.isUpdate&&!e.isInsert?((0,r.wg)(),(0,r.iD)("button",{key:0,type:"button",onClick:t[0]||(t[0]=(...e)=>l.updateButtonClickEvent&&l.updateButtonClickEvent(...e))},"확인")):e.isUpdate&&e.isInsert?((0,r.wg)(),(0,r.iD)("button",{key:1,type:"button",onClick:t[1]||(t[1]=(...e)=>l.insertButtonClickEvent&&l.insertButtonClickEvent(...e))},"등록")):e.isUpdate?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("button",{key:2,type:"button",onClick:t[2]||(t[2]=(...e)=>l.updateButtonClickEvent&&l.updateButtonClickEvent(...e))},"수정"))]),(0,r._)("td",G,[e.isInsert?((0,r.wg)(),(0,r.iD)("button",{key:0,type:"button",onClick:t[3]||(t[3]=(...e)=>l.cancelButtonClickEvent&&l.cancelButtonClickEvent(...e))},"취소")):((0,r.wg)(),(0,r.iD)("button",{key:1,type:"button",onClick:t[4]||(t[4]=(...e)=>l.deleteButtonClickEvent&&l.deleteButtonClickEvent(...e))},"삭제"))])])}var X={name:"EditableTableRow",props:{useIndex:Boolean,index:void 0|Number,initIsUpdate:Boolean,headerInfos:{type:Array,validate(e){return e.every((e=>e instanceof _))}},item:{type:Object},initIsInsert:{type:Boolean}},data:function(){return{isUpdate:this.initIsUpdate,isInsert:this.initIsInsert}},methods:{cancelButtonClickEvent(){this.$emit("cancelInsert")},selectBoxChangeEvent(e,t){const o=t.selectBoxInfo,r=o.changeInfos,i=o.selectBoxListItems,n=i.find((t=>t.key===e.target.value));n&&n.change(this.item,r)},insertButtonClickEvent(){this.$emit("insertItem",this.item),this.isInsert=!1,this.isUpdate=!1},updateButtonClickEvent(){this.isUpdate?(this.$emit("updateItem",this.id,this.item),this.isUpdate=!1):this.isUpdate=!0},deleteButtonClickEvent(){confirm("정말 삭제하시겠습니까?")&&this.$emit("deleteItem",this.id)}},computed:{id(){const e=this.headerInfos.find((e=>e.isId));return this.item[e.propertyName]}}};const ee=(0,U.Z)(X,[["render",J]]);var te=ee;Math.floor,String.fromCharCode;var oe={name:"EditableTable",components:{EditableTableRow:te,EditableTableHeader:P},props:{headerInfos:{type:Array,validate(e){return e.every((e=>e instanceof _))}},tableData:Array,emptyItem:Object,useIndex:Boolean},data:function(){return{isInsert:!1}},methods:{useInsert(){this.isInsert=!0},cancelInsert(){this.isInsert=!1},insertItem(e){this.$emit("insertItem",e),this.isInsert=!1},updateItem(e,t){this.$emit("updateItem",e,t)},deleteItem(e){this.$emit("deleteItem",e)}},computed:{columnLength(){let e=this.useIndex?3:2;return e+=this.headerInfos.length,e}}};const re=(0,U.Z)(oe,[["render",N]]);var ie=re;function ne(e){if(!e)return[];const t=[new v({itemPropertyName:"employeeNo",selectBoxItemPropertyName:"employeeNo"}),new v({itemPropertyName:"name",selectBoxItemPropertyName:"name"}),new v({itemPropertyName:"rankName",selectBoxItemPropertyName:"rankName"})],o=e.map((e=>new D({key:e.employeeNo,value:e,view:`${e.employeeNo}/${e.name}`}))),r=new x({selectBoxListItems:o,changeInfos:t});return[new _({propertyOrder:1,propertyName:"employeeNo",columnName:"사번",modifyType:"selectBox",selectBoxInfo:r}),new _({propertyOrder:2,propertyName:"name",columnName:"이름",isModify:!1,isNonVisibleUpdate:!0}),new _({propertyOrder:3,propertyName:"rankName",columnName:"직위",isModify:!1,isNonVisibleUpdate:!0}),new _({propertyOrder:4,propertyName:"workDate",columnName:"출근일",modifyType:"date"}),new _({propertyOrder:5,propertyName:"memo",columnName:"메모",modifyType:"text"}),new _({propertyOrder:999,propertyName:"holidayWorkId",isVisible:!1,isId:!0})]}var ae={name:"HolidayWorkTableContainer",components:{EditableTable:ie},data:()=>({year:(new Date).getFullYear(),month:null,query:"",headerInfos:[],holidayWorkList:[]}),computed:{years(){const e=(new Date).getFullYear(),t=[];for(let o=2015;o<=e;o++)t.push(o);return t},months(){const e=[];for(let t=1;t<=12;t++)e.push(t);return e}},methods:{async searchQuery(){const e=await k.getHolidayWorkList({query:this.query,month:this.month,year:this.year});Array.isArray(e)?this.holidayWorkList=this.orderedData(this.headerInfos,e):this.holidayWorkList=[]},getEmptyItem(){return new k.HolidayWork({})},orderedHeadersInfo(e){return e.sort(((e,t)=>e.propertyOrder-t.propertyOrder))},orderedData(e,t){const o=this.orderedHeadersInfo(e),r=t.map((e=>{const t={};return o.forEach((o=>{const r=o.propertyName;e.hasOwnProperty(r)&&(t[r]=e[r])})),t}));return r},async initHolidayWork(){const e=await k.getSimpleEmployeeList();this.headerInfos=this.orderedHeadersInfo(ne(e));const t=await k.getHolidayWorkList({});Array.isArray(t)?this.holidayWorkList=this.orderedData(this.headerInfos,t):this.holidayWorkList=[]},async insertItem(e){e||alert("업데이트 할 데이터가 없습니다.");const t=await k.insertHolidayWork(e);t&&await this.initHolidayWork()},async updateItem(e,t){e||alert("workId가 없습니다."),t||alert("업데이트 할 데이터가 없습니다.");const o=await k.updateHolidayWork(e,t);o&&await this.initHolidayWork()},async deleteItem(e){e||alert("workId가 없습니다.");const t=await k.deleteHolidayWork(e);t&&await this.initHolidayWork()}},mounted(){this.initHolidayWork()}};const se=(0,U.Z)(ae,[["render",h]]);var le=se,de={name:"holidayWorkView",components:{HolidayWorkTableContainer:le},methods:{}};const me=(0,U.Z)(de,[["render",n]]);var ye=me}}]);
//# sourceMappingURL=371.87d5a632.js.map